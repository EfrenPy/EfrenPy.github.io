(()=>{document.addEventListener("DOMContentLoaded",function(){v(),E(),w(),S(),h()});document.documentElement.style.scrollBehavior="smooth";function h(){let n=document.querySelector(".page__footer");if(n){let e=()=>{document.body.style.marginBottom=n.offsetHeight+"px"};e(),typeof ResizeObserver<"u"?new ResizeObserver(e).observe(n):window.addEventListener("resize",e)}p(),b(),y(),L(),x(),k(),window.scrollTo(0,0)}window.initPageFeatures=h;function v(){var n=document.querySelector(".nav-toggle"),e=document.querySelector(".site-nav");if(!n||!e)return;n.addEventListener("click",function(){var i=e.classList.toggle("is-open");n.setAttribute("aria-expanded",String(i)),n.classList.toggle("close",i),document.body.classList.toggle("overflow--hidden",i)});function r(){e.classList.remove("is-open"),n.setAttribute("aria-expanded","false"),n.classList.remove("close"),document.body.classList.remove("overflow--hidden")}var a=e.querySelectorAll(".nav-links a");a.forEach(function(i){i.addEventListener("click",r)});var t=window.matchMedia("(min-width: 768px)");t.addEventListener?t.addEventListener("change",function(){t.matches&&r()}):t.addListener&&t.addListener(function(){t.matches&&r()}),document.addEventListener("keydown",function(i){i.key==="Escape"&&e.classList.contains("is-open")&&(r(),n.focus())})}function p(){let n=document.querySelector(".author__urls-wrapper"),e=document.querySelector(".author__urls"),r=document.querySelector(".author__urls-wrapper button"),a=()=>{if(!e)return;let t=r!==null,i=t&&r.offsetParent!==null;!t||t&&!i?e.style.display="":e.style.display="none"};a(),window.addEventListener("resize",a),r&&e&&r.addEventListener("click",function(){let t=e.style.display==="none"||getComputedStyle(e).display==="none";e.style.display=t?"block":"none",this.classList.toggle("open"),this.setAttribute("aria-expanded",String(t))})}function b(){let n=document.querySelectorAll('a[href$=".jpg"], a[href$=".jpeg"], a[href$=".JPG"], a[href$=".png"], a[href$=".gif"], a[href$=".webp"]');if(n.length===0)return;let e=document.querySelector(".image-lightbox");if(!e){e=document.createElement("dialog"),e.className="image-lightbox",e.innerHTML=`
      <img src="" alt="Lightbox image">
      <button class="lightbox-close" aria-label="Close">&times;</button>
    `,document.body.appendChild(e);let a=document.createElement("style");a.textContent=`
      .image-lightbox {
        border: none;
        padding: 0;
        background: rgba(0, 0, 0, 0.9);
        max-width: 95vw;
        max-height: 95vh;
      }
      .image-lightbox::backdrop {
        background: rgba(0, 0, 0, 0.8);
      }
      .image-lightbox img {
        max-width: 90vw;
        max-height: 90vh;
        object-fit: contain;
        display: block;
      }
      .image-lightbox .lightbox-close {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 24px;
        cursor: pointer;
        line-height: 1;
      }
      .image-lightbox .lightbox-close:hover {
        background: #fff;
      }
    `,document.head.appendChild(a),e.querySelector(".lightbox-close").addEventListener("click",()=>e.close()),e.addEventListener("click",i=>{i.target===e&&e.close()})}let r=e.querySelector("img");n.forEach(a=>{a.addEventListener("click",function(t){t.preventDefault(),r.src=this.href,e.showModal()})})}function y(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;let n={threshold:.1,rootMargin:"0px 0px -50px 0px"},e=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&(i.target.classList.add("is-visible"),e.unobserve(i.target))})},n),r=document.querySelectorAll(".archive__item, .page__content > h2, .page__content > h3, .page__content > p, .page__content > ul, .page__content > ol, .author__urls li, .feature__item, .highlight-card, .cert-card, .contact-card, .cv-timeline-item, .cv-edu-card, .cv-skill-tag, .github-stats > a, .bento-grid > *"),a=new Map;r.forEach(t=>{if(t.classList.contains("reveal")||t.classList.contains("reveal--left")||t.classList.contains("reveal--right")){e.observe(t);return}var i=t.matches(".highlight-card, .cert-card, .contact-card, .archive__item, .cv-edu-card, .cv-timeline-item, .bento-grid > *");if(i&&t.parentElement){var c=t.parentElement,u=a.get(c)||0;a.set(c,u+1),t.style.transitionDelay=u*.08+"s",u%2===0?t.classList.add("reveal--left"):t.classList.add("reveal--right")}else if(t.classList.add("reveal"),t.matches(".author__urls li, .cv-skill-tag")){var m=t.parentElement?Array.from(t.parentElement.children):[],g=m.indexOf(t);t.style.transitionDelay=g*.05+"s"}e.observe(t)})}function L(){let n=document.querySelector(".scroll-progress"),e=document.querySelector(".masthead");if(!n)return;let r=!1,a=()=>{let t=window.scrollY,i=document.documentElement.scrollHeight-window.innerHeight,c=i>0?t/i*100:0;n.style.width=`${c}%`,e&&e.classList.toggle("is-scrolled",t>10),r=!1};window.addEventListener("scroll",()=>{r||(requestAnimationFrame(a),r=!0)},{passive:!0}),a()}function k(){var n=document.querySelector(".scroll-to-top");if(n){var e=300,r=!1,a=function(){window.scrollY>e?n.classList.add("is-visible"):n.classList.remove("is-visible"),r=!1};window.addEventListener("scroll",function(){r||(requestAnimationFrame(a),r=!0)},{passive:!0}),n.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}),a()}}function E(){let n=document.querySelector(".theme-toggle");if(!n)return;let e=t=>{document.querySelectorAll(".theme-img").forEach(i=>{i.src=i.getAttribute("data-"+t)||i.src})},r=t=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t),e(t)};n.addEventListener("click",()=>{let i=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";r(i),f(i==="dark"?"Dark mode enabled":"Light mode enabled")}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{localStorage.getItem("theme")||r(t.matches?"dark":"light")});let a=document.documentElement.getAttribute("data-theme")||"light";e(a)}function w(){let n=document.querySelector(".lang-toggle");if(!n)return;let e=r=>{document.documentElement.setAttribute("data-lang",r),localStorage.setItem("lang",r)};n.addEventListener("click",()=>{let a=document.documentElement.getAttribute("data-lang")==="en"?"es":"en";e(a),f(a==="es"?"Idioma cambiado a espa\xF1ol":"Language changed to English")})}function x(){let n=window.location.pathname;document.querySelectorAll(".nav-links a").forEach(r=>{r.classList.remove("active");let a=new URL(r.href).pathname;(n===a||a!=="/"&&n.startsWith(a))&&r.classList.add("active")})}function S(){var n=document.querySelector(".color-toggle"),e=document.querySelector(".color-picker");if(!n||!e)return;function r(o){o=o.replace("#","");var l=parseInt(o.substring(0,2),16),s=parseInt(o.substring(2,4),16),d=parseInt(o.substring(4,6),16);return l+", "+s+", "+d}function a(o,l){var s=document.documentElement;s.style.setProperty("--color-primary",o),s.style.setProperty("--color-accent",l),s.style.setProperty("--color-primary-rgb",r(o)),s.style.setProperty("--color-accent-rgb",r(l)),s.style.setProperty("--gradient-primary","linear-gradient(135deg, "+o+", "+l+")"),s.style.setProperty("--gradient-subtle","linear-gradient(135deg, "+o+"14, "+l+"14)")}function t(){e.classList.add("is-open"),n.setAttribute("aria-expanded","true");var o=e.querySelector('[aria-checked="true"]')||c[0];o&&o.focus()}function i(){e.classList.remove("is-open"),n.setAttribute("aria-expanded","false")}n.addEventListener("click",function(o){o.stopPropagation(),e.classList.contains("is-open")?i():t()}),document.addEventListener("click",function(o){!e.contains(o.target)&&o.target!==n&&i()}),document.addEventListener("keydown",function(o){o.key==="Escape"&&e.classList.contains("is-open")&&(i(),n.focus())});var c=e.querySelectorAll(".color-swatch");function u(o){var l=o.getAttribute("data-primary"),s=o.getAttribute("data-accent");c.forEach(function(d){d.classList.remove("is-active"),d.setAttribute("aria-checked","false"),d.setAttribute("tabindex","-1")}),o.classList.add("is-active"),o.setAttribute("aria-checked","true"),o.setAttribute("tabindex","0"),a(l,s),localStorage.setItem("accent-colors",JSON.stringify({primary:l,accent:s})),f("Accent color changed to "+o.getAttribute("aria-label")),i()}c.forEach(function(o,l){o.addEventListener("click",function(){u(this)}),o.addEventListener("keydown",function(s){var d;if(s.key==="ArrowRight"||s.key==="ArrowDown")s.preventDefault(),d=(l+1)%c.length;else if(s.key==="ArrowLeft"||s.key==="ArrowUp")s.preventDefault(),d=(l-1+c.length)%c.length;else if(s.key==="Enter"||s.key===" "){s.preventDefault(),u(this);return}else return;c[l].setAttribute("tabindex","-1"),c[d].setAttribute("tabindex","0"),c[d].focus()})});var m=localStorage.getItem("accent-colors");if(m)try{var g=JSON.parse(m);a(g.primary,g.accent),c.forEach(function(o){o.getAttribute("data-primary")===g.primary&&o.getAttribute("data-accent")===g.accent&&o.classList.add("is-active")})}catch{}}function f(n){var e=document.getElementById("sr-announcer");e&&(e.textContent=n,setTimeout(function(){e.textContent=""},1e3))}})();
