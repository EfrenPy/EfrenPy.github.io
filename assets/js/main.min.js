(()=>{document.addEventListener("DOMContentLoaded",function(){let n=document.querySelector(".page__footer");if(n){let o=()=>{document.body.style.marginBottom=n.offsetHeight+"px"};o(),typeof ResizeObserver<"u"?new ResizeObserver(o).observe(n):window.addEventListener("resize",o)}let r=document.querySelector(".author__urls-wrapper"),e=document.querySelector(".author__urls"),t=document.querySelector(".author__urls-wrapper button"),s=()=>{if(!e)return;let o=t!==null,a=o&&t.offsetParent!==null;!o||o&&!a?e.style.display="":e.style.display="none"};s(),window.addEventListener("resize",s),t&&e&&t.addEventListener("click",function(){let o=e.style.display==="none"||getComputedStyle(e).display==="none";e.style.display=o?"block":"none",this.classList.toggle("open")});let i=document.querySelectorAll('a[href$=".jpg"], a[href$=".jpeg"], a[href$=".JPG"], a[href$=".png"], a[href$=".gif"], a[href$=".webp"]');if(i.length>0){let o=document.createElement("dialog");o.className="image-lightbox",o.innerHTML=`
      <img src="" alt="Lightbox image">
      <button class="lightbox-close" aria-label="Close">&times;</button>
    `,document.body.appendChild(o);let a=o.querySelector("img"),l=o.querySelector(".lightbox-close"),d=document.createElement("style");d.textContent=`
      .image-lightbox {
        border: none;
        padding: 0;
        background: rgba(0, 0, 0, 0.9);
        max-width: 95vw;
        max-height: 95vh;
      }
      .image-lightbox::backdrop {
        background: rgba(0, 0, 0, 0.8);
      }
      .image-lightbox img {
        max-width: 90vw;
        max-height: 90vh;
        object-fit: contain;
        display: block;
      }
      .image-lightbox .lightbox-close {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 24px;
        cursor: pointer;
        line-height: 1;
      }
      .image-lightbox .lightbox-close:hover {
        background: #fff;
      }
    `,document.head.appendChild(d),i.forEach(c=>{c.addEventListener("click",function(h){h.preventDefault(),a.src=this.href,o.showModal()})}),l.addEventListener("click",()=>o.close()),o.addEventListener("click",c=>{c.target===o&&o.close()})}u(),m(),f(),p(),g()});document.documentElement.style.scrollBehavior="smooth";function u(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;let n={threshold:.1,rootMargin:"0px 0px -50px 0px"},r=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(s.target.classList.add("is-visible"),r.unobserve(s.target))})},n);document.querySelectorAll(".archive__item, .page__content > h2, .page__content > h3, .page__content > p, .page__content > ul, .page__content > ol, .author__urls li, .feature__item").forEach((t,s)=>{t.classList.contains("reveal")||(t.classList.add("reveal"),t.matches(".archive__item, .author__urls li")&&(t.style.transitionDelay=`${s*.05}s`)),r.observe(t)})}window.initScrollReveal=u;function m(){let n=document.querySelector(".scroll-progress"),r=document.querySelector(".masthead");if(!n)return;let e=!1,t=()=>{let s=window.scrollY,i=document.documentElement.scrollHeight-window.innerHeight,o=i>0?s/i*100:0;n.style.width=`${o}%`,r&&r.classList.toggle("is-scrolled",s>10),e=!1};window.addEventListener("scroll",()=>{e||(requestAnimationFrame(t),e=!0)},{passive:!0}),t()}function f(){let n=document.querySelector(".theme-toggle");if(!n)return;let r=e=>{document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)};n.addEventListener("click",()=>{let t=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";r(t)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||r(e.matches?"dark":"light")})}function p(){let n=document.querySelector(".lang-toggle");if(!n)return;let r=e=>{document.documentElement.setAttribute("data-lang",e),localStorage.setItem("lang",e)};n.addEventListener("click",()=>{let t=document.documentElement.getAttribute("data-lang")==="en"?"es":"en";r(t)})}function g(){let n=window.location.pathname;document.querySelectorAll(".nav-links a").forEach(e=>{e.classList.remove("active");let t=new URL(e.href).pathname;(n===t||t!=="/"&&n.startsWith(t))&&e.classList.add("active")})}window.updateActiveNav=g;})();
