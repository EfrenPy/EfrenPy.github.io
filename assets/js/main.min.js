(()=>{document.addEventListener("DOMContentLoaded",function(){g(),b(),y(),w(),u()});document.documentElement.style.scrollBehavior="smooth";function u(){let r=document.querySelector(".page__footer");if(r){let e=()=>{document.body.style.marginBottom=r.offsetHeight+"px"};e(),typeof ResizeObserver<"u"?new ResizeObserver(e).observe(r):window.addEventListener("resize",e)}m(),h(),f(),v(),L(),p(),window.scrollTo(0,0)}window.initPageFeatures=u;function g(){var r=document.querySelector(".nav-toggle"),e=document.querySelector(".site-nav");if(!r||!e)return;r.addEventListener("click",function(){var s=e.classList.toggle("is-open");r.setAttribute("aria-expanded",String(s)),r.classList.toggle("close",s),document.body.classList.toggle("overflow--hidden",s)});function n(){e.classList.remove("is-open"),r.setAttribute("aria-expanded","false"),r.classList.remove("close"),document.body.classList.remove("overflow--hidden")}var o=e.querySelectorAll(".nav-links a");o.forEach(function(s){s.addEventListener("click",n)});var t=window.matchMedia("(min-width: 768px)");t.addEventListener?t.addEventListener("change",function(){t.matches&&n()}):t.addListener&&t.addListener(function(){t.matches&&n()})}function m(){let r=document.querySelector(".author__urls-wrapper"),e=document.querySelector(".author__urls"),n=document.querySelector(".author__urls-wrapper button"),o=()=>{if(!e)return;let t=n!==null,s=t&&n.offsetParent!==null;!t||t&&!s?e.style.display="":e.style.display="none"};o(),window.addEventListener("resize",o),n&&e&&n.addEventListener("click",function(){let t=e.style.display==="none"||getComputedStyle(e).display==="none";e.style.display=t?"block":"none",this.classList.toggle("open")})}function h(){let r=document.querySelectorAll('a[href$=".jpg"], a[href$=".jpeg"], a[href$=".JPG"], a[href$=".png"], a[href$=".gif"], a[href$=".webp"]');if(r.length===0)return;let e=document.querySelector(".image-lightbox");if(!e){e=document.createElement("dialog"),e.className="image-lightbox",e.innerHTML=`
      <img src="" alt="Lightbox image">
      <button class="lightbox-close" aria-label="Close">&times;</button>
    `,document.body.appendChild(e);let o=document.createElement("style");o.textContent=`
      .image-lightbox {
        border: none;
        padding: 0;
        background: rgba(0, 0, 0, 0.9);
        max-width: 95vw;
        max-height: 95vh;
      }
      .image-lightbox::backdrop {
        background: rgba(0, 0, 0, 0.8);
      }
      .image-lightbox img {
        max-width: 90vw;
        max-height: 90vh;
        object-fit: contain;
        display: block;
      }
      .image-lightbox .lightbox-close {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 24px;
        cursor: pointer;
        line-height: 1;
      }
      .image-lightbox .lightbox-close:hover {
        background: #fff;
      }
    `,document.head.appendChild(o),e.querySelector(".lightbox-close").addEventListener("click",()=>e.close()),e.addEventListener("click",s=>{s.target===e&&e.close()})}let n=e.querySelector("img");r.forEach(o=>{o.addEventListener("click",function(t){t.preventDefault(),n.src=this.href,e.showModal()})})}function f(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;let r={threshold:.1,rootMargin:"0px 0px -50px 0px"},e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(s.target.classList.add("is-visible"),e.unobserve(s.target))})},r),n=document.querySelectorAll(".archive__item, .page__content > h2, .page__content > h3, .page__content > p, .page__content > ul, .page__content > ol, .author__urls li, .feature__item, .highlight-card, .cert-card, .contact-card, .cv-timeline-item, .cv-edu-card, .cv-skill-tag, .github-stats > a, .bento-grid > *"),o=new Map;n.forEach(t=>{if(t.classList.contains("reveal")||t.classList.contains("reveal--left")||t.classList.contains("reveal--right")){e.observe(t);return}var s=t.matches(".highlight-card, .cert-card, .contact-card, .archive__item, .cv-edu-card, .cv-timeline-item, .bento-grid > *");if(s&&t.parentElement){var l=t.parentElement,i=o.get(l)||0;o.set(l,i+1),t.style.transitionDelay=i*.08+"s",i%2===0?t.classList.add("reveal--left"):t.classList.add("reveal--right")}else if(t.classList.add("reveal"),t.matches(".author__urls li, .cv-skill-tag")){var c=t.parentElement?Array.from(t.parentElement.children):[],a=c.indexOf(t);t.style.transitionDelay=a*.05+"s"}e.observe(t)})}function v(){let r=document.querySelector(".scroll-progress"),e=document.querySelector(".masthead");if(!r)return;let n=!1,o=()=>{let t=window.scrollY,s=document.documentElement.scrollHeight-window.innerHeight,l=s>0?t/s*100:0;r.style.width=`${l}%`,e&&e.classList.toggle("is-scrolled",t>10),n=!1};window.addEventListener("scroll",()=>{n||(requestAnimationFrame(o),n=!0)},{passive:!0}),o()}function p(){var r=document.querySelector(".scroll-to-top");if(r){var e=300,n=!1,o=function(){window.scrollY>e?r.classList.add("is-visible"):r.classList.remove("is-visible"),n=!1};window.addEventListener("scroll",function(){n||(requestAnimationFrame(o),n=!0)},{passive:!0}),r.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}),o()}}function b(){let r=document.querySelector(".theme-toggle");if(!r)return;let e=n=>{document.documentElement.setAttribute("data-theme",n),localStorage.setItem("theme",n)};r.addEventListener("click",()=>{let o=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";e(o)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",n=>{localStorage.getItem("theme")||e(n.matches?"dark":"light")})}function y(){let r=document.querySelector(".lang-toggle");if(!r)return;let e=n=>{document.documentElement.setAttribute("data-lang",n),localStorage.setItem("lang",n)};r.addEventListener("click",()=>{let o=document.documentElement.getAttribute("data-lang")==="en"?"es":"en";e(o)})}function L(){let r=window.location.pathname;document.querySelectorAll(".nav-links a").forEach(n=>{n.classList.remove("active");let o=new URL(n.href).pathname;(r===o||o!=="/"&&r.startsWith(o))&&n.classList.add("active")})}function w(){var r=document.querySelector(".color-toggle"),e=document.querySelector(".color-picker");if(!r||!e)return;function n(i){i=i.replace("#","");var c=parseInt(i.substring(0,2),16),a=parseInt(i.substring(2,4),16),d=parseInt(i.substring(4,6),16);return c+", "+a+", "+d}function o(i,c){var a=document.documentElement;a.style.setProperty("--color-primary",i),a.style.setProperty("--color-accent",c),a.style.setProperty("--color-primary-rgb",n(i)),a.style.setProperty("--color-accent-rgb",n(c)),a.style.setProperty("--gradient-primary","linear-gradient(135deg, "+i+", "+c+")"),a.style.setProperty("--gradient-subtle","linear-gradient(135deg, "+i+"14, "+c+"14)")}r.addEventListener("click",function(i){i.stopPropagation(),e.classList.toggle("is-open")}),document.addEventListener("click",function(i){!e.contains(i.target)&&i.target!==r&&e.classList.remove("is-open")});var t=e.querySelectorAll(".color-swatch");t.forEach(function(i){i.addEventListener("click",function(){var c=this.getAttribute("data-primary"),a=this.getAttribute("data-accent");t.forEach(function(d){d.classList.remove("is-active")}),this.classList.add("is-active"),o(c,a),localStorage.setItem("accent-colors",JSON.stringify({primary:c,accent:a})),e.classList.remove("is-open")})});var s=localStorage.getItem("accent-colors");if(s)try{var l=JSON.parse(s);o(l.primary,l.accent),t.forEach(function(i){i.getAttribute("data-primary")===l.primary&&i.getAttribute("data-accent")===l.accent&&i.classList.add("is-active")})}catch{}}})();
