(()=>{document.addEventListener("DOMContentLoaded",function(){g(),h(),a()});document.documentElement.style.scrollBehavior="smooth";function a(){let o=document.querySelector(".page__footer");if(o){let e=()=>{document.body.style.marginBottom=o.offsetHeight+"px"};e(),typeof ResizeObserver<"u"?new ResizeObserver(e).observe(o):window.addEventListener("resize",e)}c(),l(),d(),u(),m(),window.scrollTo(0,0)}window.initPageFeatures=a;function c(){let o=document.querySelector(".author__urls-wrapper"),e=document.querySelector(".author__urls"),t=document.querySelector(".author__urls-wrapper button"),n=()=>{if(!e)return;let r=t!==null,s=r&&t.offsetParent!==null;!r||r&&!s?e.style.display="":e.style.display="none"};n(),window.addEventListener("resize",n),t&&e&&t.addEventListener("click",function(){let r=e.style.display==="none"||getComputedStyle(e).display==="none";e.style.display=r?"block":"none",this.classList.toggle("open")})}function l(){let o=document.querySelectorAll('a[href$=".jpg"], a[href$=".jpeg"], a[href$=".JPG"], a[href$=".png"], a[href$=".gif"], a[href$=".webp"]');if(o.length===0)return;let e=document.querySelector(".image-lightbox");if(!e){e=document.createElement("dialog"),e.className="image-lightbox",e.innerHTML=`
      <img src="" alt="Lightbox image">
      <button class="lightbox-close" aria-label="Close">&times;</button>
    `,document.body.appendChild(e);let n=document.createElement("style");n.textContent=`
      .image-lightbox {
        border: none;
        padding: 0;
        background: rgba(0, 0, 0, 0.9);
        max-width: 95vw;
        max-height: 95vh;
      }
      .image-lightbox::backdrop {
        background: rgba(0, 0, 0, 0.8);
      }
      .image-lightbox img {
        max-width: 90vw;
        max-height: 90vh;
        object-fit: contain;
        display: block;
      }
      .image-lightbox .lightbox-close {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 24px;
        cursor: pointer;
        line-height: 1;
      }
      .image-lightbox .lightbox-close:hover {
        background: #fff;
      }
    `,document.head.appendChild(n),e.querySelector(".lightbox-close").addEventListener("click",()=>e.close()),e.addEventListener("click",s=>{s.target===e&&e.close()})}let t=e.querySelector("img");o.forEach(n=>{n.addEventListener("click",function(r){r.preventDefault(),t.src=this.href,e.showModal()})})}function d(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;let o={threshold:.1,rootMargin:"0px 0px -50px 0px"},e=new IntersectionObserver(n=>{n.forEach(r=>{r.isIntersecting&&(r.target.classList.add("is-visible"),e.unobserve(r.target))})},o);document.querySelectorAll(".archive__item, .page__content > h2, .page__content > h3, .page__content > p, .page__content > ul, .page__content > ol, .author__urls li, .feature__item").forEach((n,r)=>{n.classList.contains("reveal")||(n.classList.add("reveal"),n.matches(".archive__item, .author__urls li")&&(n.style.transitionDelay=`${r*.05}s`)),e.observe(n)})}function u(){let o=document.querySelector(".scroll-progress"),e=document.querySelector(".masthead");if(!o)return;let t=!1,n=()=>{let r=window.scrollY,s=document.documentElement.scrollHeight-window.innerHeight,i=s>0?r/s*100:0;o.style.width=`${i}%`,e&&e.classList.toggle("is-scrolled",r>10),t=!1};window.addEventListener("scroll",()=>{t||(requestAnimationFrame(n),t=!0)},{passive:!0}),n()}function g(){let o=document.querySelector(".theme-toggle");if(!o)return;let e=t=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t)};o.addEventListener("click",()=>{let n=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";e(n)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{localStorage.getItem("theme")||e(t.matches?"dark":"light")})}function h(){let o=document.querySelector(".lang-toggle");if(!o)return;let e=t=>{document.documentElement.setAttribute("data-lang",t),localStorage.setItem("lang",t)};o.addEventListener("click",()=>{let n=document.documentElement.getAttribute("data-lang")==="en"?"es":"en";e(n)})}function m(){let o=window.location.pathname;document.querySelectorAll(".nav-links a").forEach(t=>{t.classList.remove("active");let n=new URL(t.href).pathname;(o===n||n!=="/"&&o.startsWith(n))&&t.classList.add("active")})}})();
